---
layout:     post
title:      "获取public文件"
subtitle:   "vue"
date:       2023-04-21
author:     " Shallow Dreamer "
header-img: "img/post-bg-js-version.jpg"
tags:
    - vue
    - python
---

在Vue中获取public文件夹路径可以使用相对路径，也可以使用绝对路径。相对路径可以使用`process.env.BASE_URL`变量，它会被Webpack解析为Vue应用的根路径。绝对路径可以使用`process.env.PUBLIC_URL`变量，它是public文件夹的绝对路径。

以下是一个示例代码，演示如何在Vue中获取public文件夹路径并在Python中遍历：

Vue代码：

```vue
<template>
  <div>
    <button @click="getPublicPath">获取public文件夹路径</button>
  </div>
</template>

<script>
export default {
  methods: {
    getPublicPath() {
      const publicPath = process.env.BASE_URL || process.env.PUBLIC_URL
      console.log(publicPath) // 打印public文件夹路径
      // 将public文件夹路径发送到后端进行处理
      // axios.post('/handle_public_path', { publicPath })
    }
  }
}
</script>
```

Python代码：

```python
import os

from flask import Flask, request

app = Flask(__name__)

@app.route('/handle_public_path', methods=['POST'])
def handle_public_path():
    public_path = request.json['publicPath']
    public_path = os.path.abspath(public_path)
    
    for root, dirs, files in os.walk(public_path):
        # root为当前目录的绝对路径，dirs为当前目录下的子目录名，files为当前目录下的文件名
        for file in files:
            # 处理文件
            print(os.path.join(root, file))
        for dir in dirs:
            # 处理目录
            print(os.path.join(root, dir))
    
    return 'OK'
```

在这个示例代码中，我们在Vue中定义了一个`getPublicPath()`方法，它获取public文件夹的路径并使用axios将路径发送到后端。后端使用Flask框架接收POST请求，并从请求的JSON数据中获取public文件夹路径。然后，我们使用`os.path.abspath()`函数将路径转换为绝对路径，并使用`os.walk()`函数遍历public文件夹中的所有文件和文件夹。



如果Vue项目和Python项目不在同一文件夹下，那么可以考虑使用相对路径来获取公共文件夹（public folder）的绝对路径。在Vue项目中，可以使用process.env.PUBLIC_URL来获取public文件夹的相对路径，然后在Python项目中使用os.path.join()函数将相对路径转化为绝对路径。具体实现步骤如下：

1.在Vue项目中，在组件中使用process.env.PUBLIC_URL来获取public文件夹的相对路径，如下所示：

```javascript
<script>
export default {
  mounted() {
    const publicPath = process.env.PUBLIC_URL;
    console.log(publicPath);
    // do something with publicPath, such as pass it to the backend
  },
};
</script>
```

2.将获取到的相对路径传递给后端的Python项目。在Python项目中，可以使用os.path.join()函数将相对路径转化为绝对路径，如下所示：

```python
import os

# assume publicPath is the relative path of the public folder received from frontend
publicPath = "/my/vue/project/public"
# get the absolute path of the public folder
absPath = os.path.join(os.getcwd(), publicPath)
# list all directories and files under the public folder
for root, dirs, files in os.walk(absPath):
    for file in files:
        print(os.path.join(root, file))
```

这里使用了os.path.join()函数将当前工作目录和public文件夹的相对路径连接起来得到public文件夹的绝对路径，并使用os.walk()函数遍历public文件夹下的所有文件和文件夹。



如果Vue项目和Python项目不在同一文件夹中，那么可以使用相对路径或绝对路径来访问public文件夹。以下是一种可能的解决方案：

1. 在Vue项目中，使用Node.js的path模块获取public文件夹的绝对路径，并将其保存到一个常量中。例如，在Vue组件中：

```javascript
const publicPath = path.resolve(__dirname, '../public');
```

其中，`__dirname`表示当前组件所在的目录。

2. 将上述常量通过HTTP请求或其他方式发送给Python后端，Python后端可以读取这个值，并使用它来访问Vue项目中的public文件夹。

例如，在Python中使用`os`模块来访问public文件夹：

```python
import os

public_path = '/path/to/vue/project/public'
files = os.listdir(public_path)
```

其中，`/path/to/vue/project/public`为Vue项目中public文件夹的绝对路径，可以在Python中替换为上一步中传递的值。

需要注意的是，为了保证跨平台的兼容性，建议在Vue项目中使用`path.resolve()`方法获取路径，而在Python项目中使用`os.path.join()`方法来拼接路径。



当publicPath为'/'时，可以使用以下代码来获取Vue中public文件夹的绝对路径：

```
const path = require('path');
const absolutePath = path.join(__dirname, 'public');
```

其中，__dirname是Node.js中的一个全局变量，表示当前文件所在的目录的绝对路径。

在Python中，可以使用os模块来访问这个文件夹。例如：

```
import os

public_path = '/path/to/public/folder'
files = os.listdir(public_path)
```

这里的public_path需要替换成上述代码中获取到的绝对路径。os.listdir()方法可以列出指定路径下的所有文件和文件夹。



如果vue项目和python项目不在同一个地方，并且publicPath为'/'，那么可以考虑在Vue项目中使用相对路径来获取public文件夹的绝对路径，并将该路径传递给后端的Python程序。具体步骤如下：

1. 在Vue项目中创建一个用于获取public文件夹绝对路径的函数，如下所示：

```javascript
function getPublicFolderPath() {
  const currentUrl = window.location.href;
  const currentPath = currentUrl.substr(0, currentUrl.lastIndexOf('/'));
  const publicPath = currentPath + '/public';
  return publicPath;
}
```

2. 在Vue项目中调用该函数，并将返回的路径作为参数传递给后端Python程序，如下所示：

```javascript
// 在Vue项目中调用getPublicFolderPath函数，并将返回的路径传递给后端Python程序
const publicPath = getPublicFolderPath();
axios.post('/api/get_folder_content', { publicPath }).then(response => {
  console.log(response.data);
});
```

3. 在后端的Python程序中，使用传递过来的路径来遍历public文件夹中的内容，如下所示：

```python
import os

def get_folder_content(request):
    public_path = request.POST.get('publicPath')
    file_list = []
    for root, dirs, files in os.walk(public_path):
        for file in files:
            file_path = os.path.join(root, file)
            file_list.append(file_path)
    return JsonResponse({'file_list': file_list})
```

这样，在Vue项目中通过相对路径获取public文件夹的绝对路径，再将该路径传递给后端的Python程序，就可以在Python程序中遍历public文件夹中的内容了。



如果在Vue项目中无法设置绝对路径变量，可以考虑使用相对路径获取public文件夹的绝对路径，然后在Python中使用绝对路径访问文件夹。

在Vue中，可以使用以下方法获取public文件夹的相对路径：

```
const path = require('path')
const publicPath = process.env.BASE_URL
const absolutePath = path.resolve(__dirname, publicPath)
```

其中，`process.env.BASE_URL`是通过`vue.config.js`中的`publicPath`配置获取的。`__dirname`代表当前文件的绝对路径，`path.resolve`将相对路径解析为绝对路径。

然后，可以将`absolutePath`作为参数传递给Python脚本，在Python中使用绝对路径访问public文件夹。例如：

```
import os

public_folder_path = '/path/to/public/folder'
file_list = os.listdir(public_folder_path)
```

这里的`public_folder_path`应该替换成上面获取到的`absolutePath`，`os.listdir`可以获取文件夹中的文件列表。



如果vue项目和python项目不在同一个地方，并且publicPath为'/'时，可以通过以下步骤获取vue中public的绝对路径，并在python访问其中的文件夹：

1. 在Vue项目中，使用`process.env.BASE_URL`获取当前应用的基本URL。

2. 在Vue项目中，通过创建一个全局变量来存储公共文件夹的路径，并将其赋值为`process.env.BASE_URL + 'public/'`。例如：

   ```javascript
   // 在main.js中创建全局变量
   Vue.prototype.$publicPath = process.env.BASE_URL + 'public/'
   ```

3. 在Python项目中，使用Python的`os`模块来获取Vue项目中public文件夹的绝对路径。首先，需要确定Vue项目的根目录，然后使用该路径来获取public文件夹的绝对路径。例如：

   ```python
   import os
   
   # 获取Vue项目根目录的绝对路径
   root_path = os.path.abspath(os.path.join(os.path.dirname(__file__), '../vue_project'))
   
   # 获取public文件夹的绝对路径
   public_path = os.path.join(root_path, 'public')
   ```

   这里的`__file__`表示当前Python文件的路径，`../vue_project`表示Vue项目所在的目录相对于Python项目的相对路径。

   请注意，如果Vue项目和Python项目在不同的机器上，则需要相应地更改Vue项目根目录的绝对路径。



如果Vue项目和Python项目不在同一个地方，并且`publicPath`为`'/'`，则可以通过以下方式获取Vue中`public`文件夹的绝对路径：

```js
const path = require('path')

// 获取当前文件所在的绝对路径
const currentPath = path.resolve(__dirname)

// 获取public文件夹所在的绝对路径
const publicPath = path.join(currentPath, '../public')
```

这里使用了`path`模块来获取绝对路径。首先，使用`path.resolve(__dirname)`获取当前文件所在的绝对路径；然后，使用`path.join(currentPath, '../public')`获取`public`文件夹所在的绝对路径。

在Python中访问其中的文件夹，则可以使用Python的`os`模块来实现。假设Vue中`public`文件夹所在的绝对路径为`/path/to/public`，可以在Python中使用以下代码来访问其中的文件夹：

```python
import os

public_path = '/path/to/public'

# 遍历public文件夹中的所有文件和文件夹
for dirpath, dirnames, filenames in os.walk(public_path):
    for dirname in dirnames:
        print(os.path.join(dirpath, dirname))
    for filename in filenames:
        print(os.path.join(dirpath, filename))
```



在浏览器端获取Vue项目中的public文件夹绝对路径是不太可行的，因为浏览器不允许直接访问文件系统，浏览器只能通过HTTP协议向服务器请求文件。因此，如果需要访问public文件夹中的文件，建议将这些文件上传到服务器端，然后再通过HTTP协议从服务器端获取文件。如果仅仅需要获取public文件夹的绝对路径，可以在Vue项目中定义一个全局变量来保存public文件夹的路径，然后在Vue组件中通过访问这个全局变量来获取public文件夹的路径。例如，在Vue项目的入口文件中（通常是main.js文件）可以定义一个全局变量：

```
// main.js
Vue.prototype.$publicPath = process.env.BASE_URL + 'public/';
```

然后，在Vue组件中就可以通过访问`this.$publicPath`来获取public文件夹的路径了。请注意，`process.env.BASE_URL`是Vue项目的根路径，需要根据实际情况来修改。
